}
hist(theta_boot, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
a <- 3
b <- 2
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
}
hist(theta_boot, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
theta_boot2[m] <- 1/xx[sample(n, n, replace=TRUE)]
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/xx[sample(n, n, replace=TRUE)]
}
hist(theta_boot, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
hist(theta_boot, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 30
xx <- rexp(n, 1)
a <- 3
b <- 2
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30)
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
curve(dgamma(x, 1, 10000))
curve(dgamma(x, 1, .000001))
curve(dgamma(x, 1, .000001), to=10)
n <- 30
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 10
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 10
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 10
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 10
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 5
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 5
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 5
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 5
xx <- rexp(n, 1)
a <- 1
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
curve(dgamma(x, 0.01+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
n <- 5
xx <- rexp(n, 1)
a <- 1e-6
b <- 1e-6
f2opt <- function(theta, xx, cc){
ll <- -sum(cc*dexp(xx, theta, log=TRUE))
}
M <- 10000
theta_boot <- theta_boot2 <- rep(NA, M)
for(m in 1:M){
cc <- rexp(n, 1)
fit <- optim(2, f2opt, method="Brent",
lower=0, upper=10, xx=xx, cc=cc)
theta_boot[m] <- fit$par
theta_boot2[m] <- 1/mean(xx[sample(n, n, replace=TRUE)])
}
par(mfrow=c(1,2))
hist(theta_boot, freq=F, breaks=30,
main="Power Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
hist(theta_boot2, freq=F, breaks=30,
main="Classical Bootstrap")
curve(dgamma(x, a+n,b+sum(xx)), add=TRUE, lwd=2, col='orange')
ALPHA <- 4
BETA  <- 2
kap <- 1
x <- regamma(10000, ALPHA, BETA, kap)
hist(x, breaks=30, freq=F, xlim=c(0, 7), ylim=c(0, 0.6))
par(mfrow=c(1,1))
par(mfrow=c(1,1))
ALPHA <- 4
BETA  <- 2
kap <- 1
x <- regamma(10000, ALPHA, BETA, kap)
hist(x, breaks=30, freq=F, xlim=c(0, 7), ylim=c(0, 0.6))
hist(x, breaks=40, freq=F, xlim=c(0, 7), ylim=c(0, 0.6))
curve(degamma(x, ALPHA, BETA, kap), add=TRUE,
lwd=2, col='orange')
curve(dgamma(x, ALPHA, BETA), add=TRUE,
lwd=2, col='dodgerblue', lty=3)
kap <- 100
x <- regamma(10000, ALPHA, BETA, kap)
hist(x, breaks=40, freq=F, xlim=c(0, 7), ylim=c(0, 0.6))
curve(degamma(x, ALPHA, BETA, kap), add=TRUE,
lwd=2, col='orange')
curve(dgamma(x, ALPHA, BETA), add=TRUE,
lwd=2, col='dodgerblue', lty=3)
kap <- 0.0001
x <- regamma(10000, ALPHA, BETA, kap)
hist(x, breaks=40, freq=F, xlim=c(0, 7), ylim=c(0, 0.6))
curve(degamma(x, ALPHA, BETA, kap), add=TRUE,
lwd=2, col='orange')
curve(dgamma(x, ALPHA, BETA), add=TRUE,
lwd=2, col='dodgerblue', lty=3)
kappa_vec <- 2^(-7:2)
moments <- matrix(NA, nrow=length(kappa_vec), ncol=4)
for(i in seq_along(kappa_vec)){
kappa <- kappa_vec[i]
#xx <- regamma(1000, 3, 2, kappa)
moments[i,] <- megamma(1:4, ALPHA, BETA, kappa)
}
par(mfrow=c(2,2))
MEAN <- moments[,1]
plot(1/kappa_vec, MEAN,
type='o', pch=16,
main="Mean")
VAR <- moments[,2] - moments[,1]^2
plot(1/kappa_vec, VAR,
type='o', pch=16,
main="Variance")
SKEW <- (moments[,3] - 3*moments[,1]*moments[,2] + 2*moments[,1]^3)*VAR^(-3/2)
plot(1/kappa_vec, SKEW,
type='o', pch=16,
main="Skewness")
KURT <- (moments[,4] - 4*moments[,1]*moments[,3] + 6*moments[,1]^2*moments[,2] - 3*moments[,1]^4)*VAR^(-4/2)
plot(1/kappa_vec, KURT,
type='o', pch=16,
main="Kurtosis")
ALPHA <- 4
BETA  <- 2
kap <- 0.0001
x <- regamma(10000, ALPHA, BETA, kap)
hist(x, breaks=40, freq=F, xlim=c(0, 7), ylim=c(0, 0.6))
curve(degamma(x, ALPHA, BETA, kap), add=TRUE,
lwd=2, col='orange')
par(mfrow=c(1,1))
ALPHA <- 4
BETA  <- 2
kap <- 0.0001
x <- regamma(10000, ALPHA, BETA, kap)
hist(x, breaks=40, freq=F, xlim=c(0, 7), ylim=c(0, 0.6))
curve(degamma(x, ALPHA, BETA, kap), add=TRUE,
lwd=2, col='orange')
curve(dgamma(x, ALPHA, BETA), add=TRUE,
lwd=2, col='dodgerblue', lty=3)
curve(dgamma(x, ALPHA+1, BETA), add=TRUE,
lwd=2, lty=2, col='firebrick')
ALPHA <- 4
BETA  <- 2
kap <- 1
x <- regamma(10000, ALPHA, BETA, kap)
hist(x, breaks=40, freq=F, xlim=c(0, 7), ylim=c(0, 0.6))
curve(degamma(x, ALPHA, BETA, kap), add=TRUE,
lwd=2, col='orange')
curve(dgamma(x, ALPHA, BETA), add=TRUE,
lwd=2, col='dodgerblue', lty=3)
curve(dgamma(x, ALPHA+1, BETA), add=TRUE,
lwd=2, lty=2, col='firebrick')
par(mfrow=c(1,1))
alpha <- 3
beta <- 2
kappa <- 1
w <- beta^-alpha/(beta^-alpha - (beta + kappa)^-alpha)
lambda <- alpha*w*(1 - ((w-1)/w)^(1/alpha + 1)) - alpha
bob <- RColorBrewer::brewer.pal(5, "Set1")
xx <- regamma(10000, alpha, beta, kappa)
hist(xx, freq=FALSE, breaks=40, xlim=c(0, 7), ylim=c(0, 0.7),
main = paste0("kappa = ", round(kappa, 3), ", lambda = ", round(lambda, 3)))
curve(degamma(x, alpha, beta, kappa),
lwd=2, lty=1, col=bob[1],
add=TRUE)
curve(dgamma(x, alpha, beta),
lwd=2, lty=2, col=bob[2],
add=TRUE)
curve(dgamma(x, alpha+lambda, beta),
lwd=2, lty=3, col=bob[3],
add=TRUE)
alpha <- 3
beta <- 2
kappa <- 0.5
w <- beta^-alpha/(beta^-alpha - (beta + kappa)^-alpha)
lambda <- alpha*w*(1 - ((w-1)/w)^(1/alpha + 1)) - alpha
bob <- RColorBrewer::brewer.pal(5, "Set1")
xx <- regamma(10000, alpha, beta, kappa)
hist(xx, freq=FALSE, breaks=40, xlim=c(0, 7), ylim=c(0, 0.7),
main = paste0("kappa = ", round(kappa, 3), ", lambda = ", round(lambda, 3)))
curve(degamma(x, alpha, beta, kappa),
lwd=2, lty=1, col=bob[1],
add=TRUE)
curve(dgamma(x, alpha, beta),
lwd=2, lty=2, col=bob[2],
add=TRUE)
curve(dgamma(x, alpha+lambda, beta),
lwd=2, lty=3, col=bob[3],
add=TRUE)
kappa <- 0.1
w <- beta^-alpha/(beta^-alpha - (beta + kappa)^-alpha)
lambda <- alpha*w*(1 - ((w-1)/w)^(1/alpha + 1)) - alpha
bob <- RColorBrewer::brewer.pal(5, "Set1")
xx <- regamma(10000, alpha, beta, kappa)
hist(xx, freq=FALSE, breaks=40, xlim=c(0, 7), ylim=c(0, 0.7),
main = paste0("kappa = ", round(kappa, 3), ", lambda = ", round(lambda, 3)))
curve(degamma(x, alpha, beta, kappa),
lwd=2, lty=1, col=bob[1],
add=TRUE)
curve(dgamma(x, alpha, beta),
lwd=2, lty=2, col=bob[2],
add=TRUE)
curve(dgamma(x, alpha+lambda, beta),
lwd=2, lty=3, col=bob[3],
add=TRUE)
alpha <- 3
beta <- 2
kappa <- 1000
w <- beta^-alpha/(beta^-alpha - (beta + kappa)^-alpha)
lambda <- alpha*w*(1 - ((w-1)/w)^(1/alpha + 1)) - alpha
bob <- RColorBrewer::brewer.pal(5, "Set1")
xx <- regamma(10000, alpha, beta, kappa)
hist(xx, freq=FALSE, breaks=40, xlim=c(0, 7), ylim=c(0, 0.7),
main = paste0("kappa = ", round(kappa, 3), ", lambda = ", round(lambda, 3)))
curve(degamma(x, alpha, beta, kappa),
lwd=2, lty=1, col=bob[1],
add=TRUE)
curve(dgamma(x, alpha, beta),
lwd=2, lty=2, col=bob[2],
add=TRUE)
curve(dgamma(x, alpha+lambda, beta),
lwd=2, lty=3, col=bob[3],
add=TRUE)
alpha <- 3
beta <- 2
kappa <- 1
w <- beta^-alpha/(beta^-alpha - (beta + kappa)^-alpha)
lambda <- alpha*w*(1 - ((w-1)/w)^(1/alpha + 1)) - alpha
bob <- RColorBrewer::brewer.pal(5, "Set1")
xx <- regamma(10000, alpha, beta, kappa)
hist(xx, freq=FALSE, breaks=40, xlim=c(0, 7), ylim=c(0, 0.7),
main = paste0("kappa = ", round(kappa, 3), ", lambda = ", round(lambda, 3)))
curve(degamma(x, alpha, beta, kappa),
lwd=2, lty=1, col=bob[1],
add=TRUE)
curve(dgamma(x, alpha, beta),
lwd=2, lty=2, col=bob[2],
add=TRUE)
curve(dgamma(x, alpha+lambda, beta),
lwd=2, lty=3, col=bob[3],
add=TRUE)
curve(dgamma(x, alpha+1, beta),
lwd=2, lty=4, col=bob[4],
add=TRUE)
hist(xx, freq=FALSE, breaks=40, xlim=c(0, 7), ylim=c(0, 0.7),
main = paste0("kappa = ", round(kappa, 3), ", lambda = ", round(lambda, 3)))
curve(degamma(x, alpha, beta, kappa),
lwd=2, lty=1, col=bob[1],
add=TRUE)
curve(dgamma(x, alpha, beta),
lwd=2, lty=2, col=bob[2],
add=TRUE)
curve(dgamma(x, alpha+1, beta),
lwd=2, lty=4, col=bob[4],
add=TRUE)
curve(dgamma(x, alpha+lambda, beta),
lwd=2, lty=3, col=bob[3],
add=TRUE)
megamma(1, alpha, beta, kappa)
(alpha+lambda)/beta
